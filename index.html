<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vue i18n + Logger</title>
  <script src="https://unpkg.com/vue@3"></script>
</head>
<body>
  <div id="app">
    <h1>{{ translatedHello }}</h1>

    <button @click="$log('Привет!')">Лог</button>
    <br><br>
    <button @click="$setLanguage(english)">EN</button>
    <button @click="$setLanguage(french)">FR</button>
  </div>

  <script type="module">
    const english = {
      greetings: { hello: 'Hello!', goodbye: 'Goodbye!' }
    }

    const french = {
      greetings: { hello: 'Bonjour!', goodbye: 'Au revoir!' }
    }

    const app = Vue.createApp({
      data() {
        return {
          currentLang: french,
          english,
          french
        }
      },
      computed: {
        translatedHello() {
          return this.$translate('greetings.hello')
        }
      }
    })

    // Плагины
    app.use({
      install(app, options) {
        app.config.globalProperties.$translate = (key) => {
          return key.split('.').reduce((o, i) => o?.[i], options) ?? '*перевод не найден+'
        }
        app.provide('i18n', options)
      }
    }, french)

    app.use({
      install(app) {
        app.config.globalProperties.$log = (msg) => {
          console.log(`[LOG]: ${msg}`)
        }
      }
    })

    // Смена языка
    app.config.globalProperties.$setLanguage = function(langData) {
      this.$translate = (key) => {
        return key.split('.').reduce((o, i) => o?.[i], langData) ?? '*перевод не найден+'
      }
    }.bind(app.config.globalProperties)

    app.mount('#app')
  </script>
</body>
</html>

